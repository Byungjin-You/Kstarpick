(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8859],{21277:function(e,a,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/content/movie-crawler",function(){return s(50197)}])},12779:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return t}});let t=(0,s(63759).default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},42020:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return t}});let t=(0,s(63759).default)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]])},7656:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return t}});let t=(0,s(63759).default)("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]])},50197:function(e,a,s){"use strict";s.r(a),s.d(a,{__N_SSP:function(){return y},default:function(){return v}});var t=s(85893),r=s(67294),i=s(33299),l=s(2575),n=s(44976),c=s(78865),o=s(43765),d=s(7656),m=s(69819),x=s(12779),h=s(2553),g=s(42020);s(41664);var u=s(39513);s(37677),s(25675);var p=s(11163),y=!0;function v(){var e;let{data:a,status:s}=(0,i.useSession)(),y=(0,p.useRouter)(),[v,f]=(0,r.useState)("https://mydramalist.com/search?adv=titles&ty=77&co=3&so=newest&or=asc&page=1"),[j,b]=(0,r.useState)(!1),[w,N]=(0,r.useState)(null),[k,C]=(0,r.useState)([]),[A,R]=(0,r.useState)(null),[S,I]=(0,r.useState)({}),[E,T]=(0,r.useState)({}),[O,D]=(0,r.useState)(!1),[_,P]=(0,r.useState)(null),[M,L]=(0,r.useState)(!1),[J,z]=(0,r.useState)(0),[U,B]=(0,r.useState)({open:!1,movie:null});(0,r.useEffect)(()=>{if("loading"!==s&&(!a||"admin"!==a.user.role)){y.push("/admin/login");return}},[a,s,y]);let F=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";u.toast[a](e,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},q=async()=>{try{let e;b(!0),N(null),C([]),F("영화 목록 크롤링 중입니다...","info");let a=await fetch("/api/crawler/movie-stealth-crawler",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:v,mode:"list"})});try{e=await a.json()}catch(e){throw Error("서버 응답을 처리하는 중 오류가 발생했습니다.")}if(!a.ok)throw Error(e.message||"영화 목록을 가져오는데 실패했습니다.");e.data&&e.data.movies?(C(e.data.movies),R(e.data.nextPage),F("".concat(e.data.movies.length,"개의 영화 정보를 가져왔습니다."),"success")):(N("영화 정보가 없거나 형식이 올바르지 않습니다."),F("영화 정보 가져오기에 실패했습니다.","error"))}catch(e){N(e.message||"크롤링 중 오류가 발생했습니다."),F("크롤링 오류: ".concat(e.message),"error")}finally{b(!1)}},H=async()=>{if(!A){F("더 이상 다음 페이지가 없습니다.","info");return}try{let e;b(!0),N(null),F("다음 페이지를 크롤링 중입니다...","info");let a=await fetch("/api/crawler/movie-stealth-crawler",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:A,mode:"list"})});try{e=await a.json()}catch(e){throw Error("서버 응답을 처리하는 중 오류가 발생했습니다.")}if(!a.ok)throw Error(e.message||"영화 목록을 가져오는데 실패했습니다.");e.data&&e.data.movies?(C(a=>[...a,...e.data.movies]),R(e.data.nextPage),F("".concat(e.data.movies.length,"개의 영화 정보를 추가로 가져왔습니다."),"success")):(N("영화 정보가 없거나 형식이 올바르지 않습니다."),F("영화 정보 가져오기에 실패했습니다.","error"))}catch(e){N(e.message||"크롤링 중 오류가 발생했습니다."),F("크롤링 오류: ".concat(e.message),"error")}finally{b(!1)}},X=async e=>{try{let a;b(!0),N(null),F('"'.concat(e.title,'" 영화의 상세 정보를 가져오는 중...'),"info");let s=await fetch("/api/crawler/movie-stealth-crawler",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e.url,mode:"detail"})});try{a=await s.json()}catch(e){throw Error("서버 응답을 처리하는 중 오류가 발생했습니다.")}if(!s.ok)throw Error(a.message||"영화 상세 정보를 가져오는데 실패했습니다.");let t=a.data||{},r={...e,...t,mdlId:e.id,mdlUrl:e.url};return r.credits,r.cast,["originalTitle","releaseDate","duration","runtime","country","contentRating","genres","synopsis","summary","poster","coverImage","bannerImage"].forEach(e=>{r[e]}),!r.summary&&r.synopsis&&(r.summary=r.synopsis),!r.runtime&&r.duration&&(r.runtime=r.duration),!r.ageRating&&r.contentRating&&(r.ageRating=r.contentRating),!r.coverImage&&r.poster&&(r.coverImage=r.poster),r.bannerImage||(r.bannerImage=r.coverImage||r.poster),Array.isArray(r.genres)||(r.genres=[]),Array.isArray(r.tags)||(r.tags=[]),Array.isArray(r.watchProviders)||(r.watchProviders=[]),r.credits&&(("object"!=typeof r.cast||Array.isArray(r.cast))&&(r.cast={mainRoles:[],supportRoles:[]}),Array.isArray(r.credits.mainCast)&&(r.cast.mainRoles=r.credits.mainCast),Array.isArray(r.credits.supportCast)&&(r.cast.supportRoles=r.credits.supportCast)),P(r),B({open:!0,movie:r}),F('"'.concat(e.title,'" 영화의 상세 정보를 가져왔습니다.'),"success"),r}catch(e){return N(e.message||"상세 정보 크롤링 중 오류가 발생했습니다."),F("크롤링 오류: ".concat(e.message),"error"),null}finally{b(!1)}},G=async e=>{if(!e){F("저장할 영화 데이터가 없습니다.","error");return}try{let a;if(T(a=>({...a,[e.mdlId]:"saving"})),e.credits){if(Array.isArray(e.credits.mainCast)||Array.isArray(e.credits.supportCast)){let a=Array.isArray(e.credits.mainCast)?e.credits.mainCast:[],s=Array.isArray(e.credits.supportCast)?e.credits.supportCast:[],t=new Set,r=[...a.filter(e=>!!e&&!!e.name&&!t.has(e.name)&&(t.add(e.name),!0)).map((e,a)=>({name:e.name||"N/A",role:e.role||(e.character?e.character:"Main Role"),image:e.image||"",order:a})),...s.filter(e=>!!e&&!!e.name&&!t.has(e.name)&&(t.add(e.name),!0)).map((e,s)=>({name:e.name||"N/A",role:e.role||(e.character?e.character:"Support Role"),image:e.image||"",order:a.length+s}))];e.cast=r}}else if(e.cast&&"object"==typeof e.cast&&!Array.isArray(e.cast)){let a=Array.isArray(e.cast.mainRoles)?e.cast.mainRoles:[],s=Array.isArray(e.cast.supportRoles)?e.cast.supportRoles:[],t=new Set,r=[...a.filter(e=>!!e&&!!e.name&&!t.has(e.name)&&(t.add(e.name),!0)).map((e,a)=>({name:e.name||"N/A",role:e.role||"Main Role",image:e.image||"",order:a})),...s.filter(e=>!!e&&!!e.name&&!t.has(e.name)&&(t.add(e.name),!0)).map((e,s)=>({name:e.name||"N/A",role:e.role||"Support Role",image:e.image||"",order:a.length+s}))];e.cast=r}let s={...e,category:"movie",status:e.status||"completed",originalTitle:e.originalTitle||"",summary:e.synopsis||e.summary||"",content:e.synopsis||e.content||e.summary||"",releaseDate:e.releaseDate||null,director:e.director||"",runtime:e.duration||e.runtime||"",country:e.country||"South Korea",ageRating:e.contentRating||"",genres:Array.isArray(e.genres)?e.genres:[],tags:Array.isArray(e.tags)?e.tags:[],coverImage:e.poster||e.coverImage||"/images/placeholder-tvfilm.svg",bannerImage:e.bannerImage||e.poster||"/images/placeholder-tvfilm.svg",watchProviders:Array.isArray(e.watchProviders)?e.watchProviders:[],createdAt:new Date,updatedAt:new Date},t=localStorage.getItem("token")||localStorage.getItem("adminToken"),r=await fetch("/api/dramas",{method:"POST",headers:{"Content-Type":"application/json",Authorization:t?"Bearer ".concat(t):""},body:JSON.stringify(s)});try{a=await r.json()}catch(e){throw Error("서버 응답을 처리하는 중 오류가 발생했습니다.")}if(!r.ok)throw Error(a.message||"영화 저장에 실패했습니다.");return T(a=>({...a,[e.mdlId]:"saved"})),F('"'.concat(e.title,'" 영화를 저장했습니다.'),"success"),a.data}catch(a){return T(a=>({...a,[e.mdlId]:"error"})),F("저장 오류: ".concat(a.message),"error"),null}},K=async()=>{let e=Object.keys(S).filter(e=>S[e]);if(0===e.length){F("저장할 영화를 선택해주세요.","warning");return}let a=0,s=0;for(let t of e){let e=k.find(e=>e.id===t);if(e)try{await X(e),await G(_),a++}catch(e){s++}}F("".concat(a,"개 영화 저장 완료, ").concat(s,"개 실패"),a>0?"success":"warning")},W=e=>{I(a=>({...a,[e]:!a[e]}))},Q=e=>{let a=E[e];return"saving"===a?(0,t.jsx)(n.default,{className:"animate-spin h-4 w-4 text-blue-500"}):"saved"===a?(0,t.jsx)(c.default,{className:"h-4 w-4 text-green-500"}):"error"===a?(0,t.jsx)(o.default,{className:"h-4 w-4 text-red-500"}):null},V=async(e,a)=>{if(!e||!a){F("영화 ID와 URL이 필요합니다.","error");return}try{let t;L(!0),F("리뷰를 크롤링 중입니다...","info");let r=await fetch("/api/crawler/movie-reviews-stealth-crawler",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:"".concat(a,"/reviews"),dramaId:e})});try{t=await r.json()}catch(e){throw Error("서버 응답을 처리하는 중 오류가 발생했습니다.")}if(!r.ok)throw Error(t.message||"리뷰를 가져오는데 실패했습니다.");if(t.data&&t.data.reviewCount){var s;z(t.data.reviewCount),B(e=>({...e,movie:{...e.movie,reviewCount:t.data.reviewCount,reviewRating:t.data.reviewRating,ratingDistribution:t.data.ratingDistribution}})),F("".concat(t.data.reviewCount,"개의 리뷰를 크롤링했습니다. 평균 평점: ").concat(null===(s=t.data.reviewRating)||void 0===s?void 0:s.toFixed(1)),"success")}else F("리뷰를 크롤링 했으나 결과가 없습니다.","warning")}catch(e){F("리뷰 크롤링 오류: ".concat(e.message),"error")}finally{L(!1)}};return(0,t.jsxs)(l.default,{children:[(0,t.jsxs)("div",{className:"container px-4 py-6 mx-auto",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"영화 크롤러"}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"MyDramaList 영화 크롤링"}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-3 mb-4",children:[(0,t.jsxs)("div",{className:"flex-grow",children:[(0,t.jsx)("label",{htmlFor:"url",className:"block text-sm font-medium text-gray-700 mb-1",children:"크롤링 URL"}),(0,t.jsx)("input",{type:"text",id:"url",value:v,onChange:e=>{f(e.target.value)},className:"block w-full border border-gray-300 rounded px-3 py-2 text-sm",placeholder:"https://mydramalist.com/search?adv=titles&ty=77&co=3&so=newest&or=asc&page=1"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"MyDramaList 영화 검색 결과 페이지 URL을 입력하세요. (ty=77은 영화를 의미)"})]}),(0,t.jsx)("div",{className:"flex items-end",children:(0,t.jsxs)("button",{onClick:q,disabled:j,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded flex items-center gap-2 whitespace-nowrap disabled:bg-blue-400",children:[j?(0,t.jsx)(n.default,{className:"animate-spin h-4 w-4"}):(0,t.jsx)(x.default,{className:"h-4 w-4"}),"스텔스 크롤링"]})})]}),w&&(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-2 rounded text-sm mb-4",children:w})]}),k.length>0&&(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsxs)("h2",{className:"text-lg font-semibold",children:["크롤링된 영화 목록 (",k.length,"개)"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("button",{onClick:()=>{if(Object.keys(S).length===k.length&&Object.values(S).every(e=>e))I({});else{let e={};k.forEach(a=>{e[a.id]=!0}),I(e)}},className:"bg-gray-100 hover:bg-gray-200 text-gray-800 px-3 py-1 rounded text-sm flex items-center gap-1",children:[(0,t.jsx)(c.default,{className:"h-4 w-4"}),"전체 선택/해제"]}),(0,t.jsxs)("button",{onClick:K,disabled:j||0===Object.keys(S).filter(e=>S[e]).length,className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm flex items-center gap-1 disabled:bg-green-400",children:[(0,t.jsx)(m.default,{className:"h-4 w-4"}),"선택 저장"]}),A&&(0,t.jsxs)("button",{onClick:H,disabled:j,className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm flex items-center gap-1 disabled:bg-blue-400",children:[j?(0,t.jsx)(n.default,{className:"animate-spin h-4 w-4"}):(0,t.jsx)(h.default,{className:"h-4 w-4"}),"다음 페이지"]})]})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-10",children:"선택"}),(0,t.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-14",children:"이미지"}),(0,t.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"제목"}),(0,t.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"평점"}),(0,t.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"연도"}),(0,t.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"상태"}),(0,t.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-32",children:"작업"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:k.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,t.jsx)("input",{type:"checkbox",checked:S[e.id]||!1,onChange:()=>W(e.id),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:e.image?(0,t.jsx)("div",{className:"w-10 h-14 relative overflow-hidden rounded",children:(0,t.jsx)("img",{src:e.image,alt:e.title,className:"object-cover w-full h-full",onError:e=>{e.target.src="/images/placeholder-poster.png"}})}):(0,t.jsx)("div",{className:"w-10 h-14 bg-gray-200 flex items-center justify-center rounded",children:(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"없음"})})}),(0,t.jsxs)("td",{className:"px-4 py-4",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:e.id}),(0,t.jsx)("div",{className:"text-xs text-blue-500 hover:underline",children:(0,t.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1",children:[(0,t.jsx)(g.default,{className:"h-3 w-3"}),"MDL"]})})]}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:e.rating?(0,t.jsx)("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:e.rating}):(0,t.jsx)("span",{className:"text-gray-400 text-xs",children:"-"})}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:e.year||"-"}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:Q(e.id)||(0,t.jsx)("span",{className:"text-xs text-gray-400",children:"대기중"})}),(0,t.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>X(e),disabled:j,className:"text-blue-600 hover:text-blue-900 text-xs flex items-center gap-1",children:"상세정보"}),(0,t.jsx)("button",{onClick:async()=>{await X(e),_&&await G(_)},disabled:j||"saving"===E[e.id]||"saved"===E[e.id],className:"text-green-600 hover:text-green-900 text-xs flex items-center gap-1",children:"저장"})]})})]},e.id))})]})})]})]}),U.open&&U.movie?(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-auto",children:(0,t.jsx)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-auto",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsx)("h2",{className:"text-xl font-bold",children:U.movie.title}),(0,t.jsx)("button",{onClick:()=>B({open:!1,movie:null}),className:"text-gray-500 hover:text-gray-700",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"md:col-span-1",children:[U.movie.poster?(0,t.jsx)("div",{className:"relative w-full aspect-[2/3] rounded overflow-hidden",children:(0,t.jsx)("img",{src:U.movie.poster,alt:U.movie.title,className:"object-cover w-full h-full"})}):(0,t.jsx)("div",{className:"w-full aspect-[2/3] bg-gray-200 flex items-center justify-center rounded",children:(0,t.jsx)("span",{className:"text-gray-400",children:"이미지 없음"})}),(0,t.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"평점:"}),(0,t.jsx)("span",{className:"font-semibold",children:U.movie.rating||"정보 없음"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"연도:"}),(0,t.jsx)("span",{className:"font-semibold",children:U.movie.year||"정보 없음"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"국가:"}),(0,t.jsx)("span",{className:"font-semibold",children:U.movie.country||"정보 없음"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"리뷰:"}),(0,t.jsx)("span",{className:"font-semibold",children:U.movie.reviewCount||"0"})]})]})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"상세 정보"}),U.movie.originalTitle&&(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:"원제: "}),(0,t.jsx)("span",{children:U.movie.originalTitle})]}),U.movie.genres&&U.movie.genres.length>0&&(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:"장르: "}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:U.movie.genres.map((e,a)=>(0,t.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded",children:e},a))})]}),U.movie.synopsis&&(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:"줄거리: "}),(0,t.jsx)("p",{className:"text-sm mt-1 text-gray-700",children:U.movie.synopsis})]}),U.movie.cast&&U.movie.cast.mainRoles&&U.movie.cast.mainRoles.length>0&&(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:"주요 출연진: "}),(0,t.jsx)("ul",{className:"list-disc list-inside text-sm mt-1",children:U.movie.cast.mainRoles.map((e,a)=>(0,t.jsxs)("li",{children:[e.name," ",e.role?" - ".concat(e.role):""]},a))})]}),U.movie.releaseDate&&(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:"개봉일: "}),(0,t.jsx)("span",{children:U.movie.releaseDate})]}),U.movie.duration&&(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:"상영 시간: "}),(0,t.jsx)("span",{children:U.movie.duration})]}),U.movie.contentRating&&(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:"등급: "}),(0,t.jsx)("span",{children:U.movie.contentRating})]})]})]}),(0,t.jsxs)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"리뷰 정보"}),U.movie.reviewCount>0?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"평균 평점:"}),(0,t.jsx)("span",{className:"font-semibold",children:(null===(e=U.movie.reviewRating)||void 0===e?void 0:e.toFixed(1))||"0"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-500",children:"평점 분포:"}),(0,t.jsx)("div",{className:"flex mt-1 gap-1 h-24",children:U.movie.ratingDistribution&&U.movie.ratingDistribution.map((e,a)=>(0,t.jsxs)("div",{className:"flex flex-col items-center w-8",children:[(0,t.jsx)("div",{className:"flex-grow w-full bg-gray-100 relative",children:(0,t.jsx)("div",{className:"absolute bottom-0 w-full bg-blue-500",style:{height:"".concat(e>0?Math.max(e/Math.max(...U.movie.ratingDistribution)*100,10):0,"%")}})}),(0,t.jsx)("span",{className:"text-xs mt-1",children:a+1})]},a))})]})]}):(0,t.jsx)("div",{className:"text-gray-500",children:"아직 리뷰 정보가 없습니다. 리뷰를 크롤링하세요."})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,t.jsx)("button",{onClick:()=>B({open:!1,movie:null}),className:"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50 text-sm",children:"닫기"}),(0,t.jsxs)("button",{onClick:()=>V(U.movie._id,U.movie.url),disabled:M,className:"px-4 py-2 bg-purple-600 rounded text-white hover:bg-purple-700 text-sm flex items-center gap-1 disabled:bg-purple-400",children:[M?(0,t.jsx)(n.default,{className:"animate-spin h-4 w-4"}):(0,t.jsx)(d.default,{className:"h-4 w-4"}),"리뷰 크롤링"]}),(0,t.jsxs)("button",{onClick:()=>G(U.movie),disabled:j||"saving"===E[U.movie.mdlId]||"saved"===E[U.movie.mdlId],className:"px-4 py-2 bg-blue-600 rounded text-white hover:bg-blue-700 text-sm flex items-center gap-1 disabled:bg-blue-400",children:["saving"===E[U.movie.mdlId]?(0,t.jsx)(n.default,{className:"animate-spin h-4 w-4"}):(0,t.jsx)(m.default,{className:"h-4 w-4"}),"데이터베이스에 저장"]})]})]})})}):null,(0,t.jsx)(u.ToastContainer,{})]})}}},function(e){e.O(0,[1664,5089,628,9643,2888,9774,179],function(){return e(e.s=21277)}),_N_E=e.O()}]);