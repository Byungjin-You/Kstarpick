(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3871],{35005:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/content",function(){return a(84826)}])},2575:function(e,t,a){"use strict";a.r(t);var s=a(85893),l=a(67294),r=a(41664),n=a.n(r),i=a(11163),d=a(33299),c=a(43765),o=a(38361),x=a(2553),m=a(63594),h=a(2287),u=a(89176),g=a(55264),p=a(70095),f=a(77362),j=a(94086),b=a(70088),y=a(70775);t.default=e=>{let{children:t}=e,a=(0,i.useRouter)(),{data:r,status:N}=(0,d.useSession)(),[v,w]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{("unauthenticated"===N||r&&"admin"!==r.user.role)&&a.push("/admin/login")},[r,N,a]),"loading"===N)?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:(0,s.jsx)("div",{className:"p-8 bg-white rounded-lg shadow-md",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 border-4 border-t-[#ff3e8e] rounded-full animate-spin"}),(0,s.jsx)("p",{className:"text-xl font-medium",children:"Loading admin panel..."})]})})}):"unauthenticated"===N||r&&"admin"!==r.user.role?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:(0,s.jsx)("div",{className:"p-8 bg-white rounded-lg shadow-md max-w-md",children:(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-4 text-center",children:[(0,s.jsx)(c.default,{size:48,className:"text-red-500"}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Unauthorized Access"}),(0,s.jsx)("p",{className:"text-gray-600",children:"You don't have permission to access the admin area."}),(0,s.jsx)(n(),{href:"/",className:"px-4 py-2 mt-4 text-white bg-[#ff3e8e] rounded-md hover:bg-[#e02e7c]",children:"Go to Homepage"})]})})}):(o.default,x.default,m.default,h.default,u.default,g.default,(0,s.jsx)("div",{className:"min-h-screen bg-gray-100",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsxs)("div",{className:"w-64 min-h-screen bg-white shadow-md",children:[(0,s.jsx)("div",{className:"p-4 border-b",children:(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"관리자 패널"})}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsxs)("ul",{className:"space-y-2",children:[(0,s.jsx)("li",{children:(0,s.jsxs)(n(),{href:"/admin",className:"flex items-center px-4 py-2 rounded-lg ".concat("/admin"===a.pathname?"bg-blue-600 text-white":"text-gray-800 hover:bg-blue-100"),children:[(0,s.jsx)(o.default,{className:"mr-3 h-5 w-5"}),"대시보드"]})}),(0,s.jsx)("li",{children:(0,s.jsxs)(n(),{href:"/admin/content",className:"flex items-center px-4 py-2 rounded-lg ".concat(a.pathname.startsWith("/admin/content")?"bg-blue-600 text-white":"text-gray-800 hover:bg-blue-100"),children:[(0,s.jsx)(p.default,{className:"mr-3 h-5 w-5"}),"콘텐츠 관리"]})}),(0,s.jsx)("li",{children:(0,s.jsxs)(n(),{href:"/admin/news",className:"flex items-center px-4 py-2 rounded-lg ".concat(a.pathname.startsWith("/admin/news")?"bg-blue-600 text-white":"text-gray-800 hover:bg-blue-100"),children:[(0,s.jsx)(f.default,{className:"mr-3 h-5 w-5"}),"뉴스 관리"]})}),(0,s.jsx)("li",{children:(0,s.jsxs)(n(),{href:"/admin/drama",className:"flex items-center px-4 py-2 rounded-lg ".concat(a.pathname.startsWith("/admin/drama")?"bg-blue-600 text-white":"text-gray-800 hover:bg-blue-100"),children:[(0,s.jsx)(j.default,{className:"mr-3 h-5 w-5"}),"드라마 관리"]})}),(0,s.jsx)("li",{children:(0,s.jsxs)(n(),{href:"/admin/music",className:"flex items-center px-4 py-2 rounded-lg ".concat(a.pathname.startsWith("/admin/music")?"bg-blue-600 text-white":"text-gray-800 hover:bg-blue-100"),children:[(0,s.jsx)(h.default,{className:"mr-3 h-5 w-5"}),"음악 차트 관리"]})}),(0,s.jsx)("li",{children:(0,s.jsxs)(n(),{href:"/admin/celeb",className:"flex items-center px-4 py-2 rounded-lg ".concat(a.pathname.startsWith("/admin/celeb")?"bg-blue-600 text-white":"text-gray-800 hover:bg-blue-100"),children:[(0,s.jsx)(b.default,{className:"mr-3 h-5 w-5"}),"셀럽 관리"]})}),(0,s.jsx)("li",{children:(0,s.jsxs)(n(),{href:"/admin/users",className:"flex items-center px-4 py-2 rounded-lg ".concat(a.pathname.startsWith("/admin/users")?"bg-blue-600 text-white":"text-gray-800 hover:bg-blue-100"),children:[(0,s.jsx)(u.default,{className:"mr-3 h-5 w-5"}),"사용자 관리"]})})]}),(0,s.jsx)("div",{className:"border-t mt-4 pt-4",children:(0,s.jsxs)("button",{onClick:()=>{localStorage.removeItem("adminToken"),sessionStorage.removeItem("adminToken"),(0,d.signOut)({callbackUrl:"/"})},className:"flex items-center w-full px-4 py-2 rounded-lg text-red-600 hover:bg-red-50 transition-colors",children:[(0,s.jsx)(y.default,{className:"mr-3 h-5 w-5"}),"로그아웃"]})})]})]}),(0,s.jsx)("div",{className:"flex-1",children:t})]})}))}},84826:function(e,t,a){"use strict";a.r(t),a.d(t,{__N_SSP:function(){return O},default:function(){return B}});var s,l=a(85893),r=a(67294),n=a(11163),i=a(41664),d=a.n(i),c=a(33299),o=a(2575),x=a(31955),m=a(12895),h=a(12779),u=a(40976),g=a(36127),p=a(62634),f=a(70088),j=a(15928),b=a(96815),y=a(37864),N=a(61258),v=a(4307),w=a(9289),k=a(495),S=a(25675),T=a.n(S),C=a(92137),z=a(21449),I=a(76809),_=a(50447),A=a(85830),E=a(78738),O=!0,B=(s=function(){let e=(0,n.useRouter)(),[t,a]=(0,r.useState)([]),[s,i]=(0,r.useState)(!0),[c,x]=(0,r.useState)(null),[S,O]=(0,r.useState)({visible:!1,message:"",type:""}),[B,D]=(0,r.useState)(null),[M,R]=(0,r.useState)(""),[P,L]=(0,r.useState)(""),[W,U]=(0,r.useState)(1),[q,G]=(0,r.useState)(1),[H,J]=(0,r.useState)(0),[F,X]=(0,r.useState)("createdAt"),[Y,K]=(0,r.useState)("desc"),[Q,V]=(0,r.useState)(10),Z=()=>{let e=localStorage.getItem("token")||localStorage.getItem("adminToken"),t={hasToken:!!e,tokenLength:e?e.length:0,tokenStart:e?e.substring(0,20)+"...":"None",localStorage:{token:!!localStorage.getItem("token"),adminToken:!!localStorage.getItem("adminToken")}};return D(t),t};(0,r.useEffect)(()=>{let{type:t,search:a,page:s}=e.query;Z(),t&&R(t),a&&L(a),s&&U(parseInt(s,10))},[e.query]);let $=async()=>{i(!0),x(null);try{let e;let t=new URLSearchParams({page:W,limit:Q,sortBy:F,sortOrder:Y});M&&"all"!==M&&t.append("category",M),P&&t.append("title",P);let s=localStorage.getItem("token")||localStorage.getItem("adminToken"),l=await fetch("".concat("/api/dramas","?").concat(t.toString()),{headers:{Authorization:s?"Bearer ".concat(s):""}}),r=await l.json();if(!l.ok)throw Error(r.message||"콘텐츠 목록을 불러오는 중 오류가 발생했습니다.");(e={data:r.data.map(e=>({...e,contentType:e.category||M})),pagination:r.pagination}).data.length,a(e.data),G(e.pagination.pages),J(e.pagination.total)}catch(e){x(e.message),es(e.message,"error")}finally{i(!1)}};(0,r.useEffect)(()=>{{let t=localStorage.getItem("token")||localStorage.getItem("adminToken");t?ee(t):e.push("/admin/login")}},[W,Q,F,Y,M]);let ee=async t=>{try{let a=await fetch("/api/auth/check-admin",{headers:{Authorization:"Bearer ".concat(t)}});(await a.json()).isAdmin?$():e.push("/admin/login")}catch(t){e.push("/admin/login")}},et=async(e,t,a)=>{if(confirm('"'.concat(t,'" 콘텐츠를 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.')))try{let t=a;t||(t=M||"content");let s=localStorage.getItem("token")||localStorage.getItem("adminToken"),l=await fetch("/api/dramas/".concat(e),{method:"DELETE",headers:{Authorization:s?"Bearer ".concat(s):""}});if(!l.ok){let e=await l.json();throw Error(e.message||"콘텐츠 삭제 중 오류가 발생했습니다.")}await l.json(),$(),es("콘텐츠가 성공적으로 삭제되었습니다.","success")}catch(e){es(e.message,"error")}},ea=e=>{F===e?K("asc"===Y?"desc":"asc"):(X(e),K("desc"))},es=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";O({visible:!0,message:e,type:t}),setTimeout(()=>O({visible:!1,message:"",type:""}),3e3)},el=e=>({drama:"드라마",movie:"영화",variety:"예능",documentary:"다큐멘터리",other:"기타"})[e]||e,er=e=>({ongoing:"방영 중",completed:"완결",upcoming:"개봉 예정",canceled:"취소됨"})[e]||e,en=async(e,a,s)=>{try{let l;let r=t.find(t=>t._id===e);if(!r)return;let n=localStorage.getItem("token")||localStorage.getItem("adminToken");l="Movie"===r.category||"movie"===r.category||"Movie"===s||"movie"===s?"/api/tvfilm/".concat(e):"/api/dramas/".concat(e);let i=await fetch(l,{method:"PUT",headers:{Authorization:n?"Bearer ".concat(n):"","Content-Type":"application/json"},body:JSON.stringify({...r,orderNumber:a,previousOrderNumber:r.orderNumber||a})});if(!i.ok)throw await i.text(),Error("순위 업데이트에 실패했습니다. (".concat(i.status,")"));$(),es("순위가 성공적으로 업데이트되었습니다.","success")}catch(e){es("순위 업데이트 중 오류가 발생했습니다: ".concat(e.message),"error")}},ei=async()=>{try{let e=await fetch("/api/auth/generate-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"admin",password:"admin123"})});if(e.ok){let t=await e.json();localStorage.setItem("adminToken",t.token),Z(),es("토큰이 재생성되었습니다.","success")}else es("토큰 재생성에 실패했습니다.","error")}catch(e){es("토큰 재생성 중 오류가 발생했습니다.","error")}},ed=(e,a)=>{let s=t.findIndex(t=>t._id===e);if(-1===s)return;let l=t[s];"up"===a&&s>0?en(e,Math.max(1,(t[s-1].orderNumber||s)-1),l.contentType||l.category):"down"===a&&s<t.length-1&&en(e,(t[s+1].orderNumber||s+2)+1,l.contentType||l.category)},ec=async()=>{if(0!==t.length)try{let e=localStorage.getItem("token")||localStorage.getItem("adminToken"),a=[...t].sort((e,t)=>new Date(t.createdAt||t.updatedAt)-new Date(e.createdAt||e.updatedAt)),s=a.map(async(t,a)=>{let s=a+1;return fetch("/api/dramas/".concat(t._id),{method:"PUT",headers:{Authorization:e?"Bearer ".concat(e):"","Content-Type":"application/json"},body:JSON.stringify({orderNumber:s,previousOrderNumber:t.orderNumber||s})})});await Promise.all(s),$(),es("".concat(a.length,"개 콘텐츠의 순위가 최신순으로 정렬되었습니다."),"success")}catch(e){es("순위 정렬 중 오류가 발생했습니다.","error")}};return(0,l.jsxs)(o.default,{children:[(0,l.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"콘텐츠 관리"}),B&&(0,l.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:["토큰 상태: ",B.hasToken?"✅ 있음":"❌ 없음",B.hasToken&&"(길이: ".concat(B.tokenLength,")"),!B.hasToken&&(0,l.jsx)("button",{onClick:ei,className:"ml-2 text-blue-600 hover:text-blue-800 underline",children:"토큰 재생성"})]})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)("button",{onClick:ec,className:"bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md flex items-center",disabled:s,children:[(0,l.jsx)(m.default,{className:"mr-2 h-5 w-5"}),"순위 정렬"]}),(0,l.jsxs)(d(),{href:"/admin/content/movie-crawler",className:"bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md flex items-center",children:[(0,l.jsx)(h.default,{className:"mr-2 h-5 w-5"}),"영화 크롤러"]}),(0,l.jsxs)(d(),{href:"/admin/content/reviews-crawler",className:"bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md flex items-center",children:[(0,l.jsx)(h.default,{size:18,className:"mr-1"}),"리뷰 크롤러"]}),(0,l.jsxs)(d(),{href:"/admin/content/crawler",className:"bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-md flex items-center",children:[(0,l.jsx)(h.default,{size:18,className:"mr-1"}),"드라마 크롤러"]}),(0,l.jsxs)(d(),{href:"/admin/content/new",className:"bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md flex items-center",children:[(0,l.jsx)(u.default,{size:18,className:"mr-1"}),"신규 콘텐츠 등록"]})]})]}),(0,l.jsxs)(C.default,{container:!0,spacing:3,className:"mb-6",children:[(0,l.jsx)(C.default,{item:!0,xs:12,md:4,children:(0,l.jsxs)(z.default,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,l.jsxs)(I.default,{sx:{flexGrow:1},children:[(0,l.jsx)(_.default,{gutterBottom:!0,variant:"h5",component:"h2",children:"드라마 크롤러"}),(0,l.jsx)(_.default,{children:"MyDramalist에서 드라마/영화 정보와 배우 정보를 크롤링합니다."})]}),(0,l.jsx)(A.default,{children:(0,l.jsx)(d(),{href:"/admin/content/crawler",passHref:!0,children:(0,l.jsx)(E.default,{size:"small",variant:"contained",color:"secondary",children:"크롤러 시작"})})})]})}),(0,l.jsx)(C.default,{item:!0,xs:12,md:4,children:(0,l.jsxs)(z.default,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,l.jsxs)(I.default,{sx:{flexGrow:1},children:[(0,l.jsx)(_.default,{gutterBottom:!0,variant:"h5",component:"h2",children:"리뷰 스텔스 크롤러"}),(0,l.jsx)(_.default,{children:"MyDramalist 드라마/영화 리뷰를 Cloudflare 보호를 우회하여 스텔스 크롤링합니다."})]}),(0,l.jsx)(A.default,{children:(0,l.jsx)(d(),{href:"/admin/content/reviews-crawler",passHref:!0,children:(0,l.jsx)(E.default,{size:"small",variant:"contained",color:"success",children:"크롤러 시작"})})})]})}),(0,l.jsx)(C.default,{item:!0,xs:12,md:4,children:(0,l.jsxs)(z.default,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,l.jsxs)(I.default,{sx:{flexGrow:1},children:[(0,l.jsx)(_.default,{gutterBottom:!0,variant:"h5",component:"h2",children:"콘텐츠 신규 등록"}),(0,l.jsx)(_.default,{children:"드라마, 영화, 예능 등 새로운 콘텐츠를 직접 등록합니다."})]}),(0,l.jsx)(A.default,{children:(0,l.jsx)(d(),{href:"/admin/content/new",passHref:!0,children:(0,l.jsx)(E.default,{size:"small",variant:"contained",color:"primary",children:"콘텐츠 등록"})})})]})})]}),(0,l.jsx)("div",{className:"bg-white shadow rounded-lg p-4 mb-6",children:(0,l.jsxs)("div",{className:"flex flex-wrap gap-4 items-end",children:[(0,l.jsxs)("div",{className:"flex-1 min-w-[200px]",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"콘텐츠 타입"}),(0,l.jsxs)("select",{className:"w-full border border-gray-300 rounded-md px-3 py-2",value:M,onChange:t=>{let a=t.target.value;R(a),U(1);let s={...e.query};a?s.type=a:delete s.type,e.push({pathname:e.pathname,query:s},void 0,{shallow:!0})},children:[(0,l.jsx)("option",{value:"",children:"전체 타입"}),(0,l.jsx)("option",{value:"all",children:"모든 타입 보기"}),(0,l.jsx)("option",{value:"drama",children:"드라마"}),(0,l.jsx)("option",{value:"movie",children:"영화"}),(0,l.jsx)("option",{value:"variety",children:"예능"}),(0,l.jsx)("option",{value:"documentary",children:"다큐멘터리"}),(0,l.jsx)("option",{value:"other",children:"기타"})]})]}),(0,l.jsx)("div",{className:"flex-1 flex min-w-[300px]",children:(0,l.jsxs)("form",{onSubmit:t=>{t.preventDefault(),U(1);let a={...e.query};P?a.search=P:delete a.search,delete a.page,e.push({pathname:e.pathname,query:a},void 0,{shallow:!0}),$()},className:"w-full flex",children:[(0,l.jsx)("input",{type:"text",placeholder:"제목 검색...",className:"flex-1 border border-gray-300 rounded-l-md px-3 py-2",value:P,onChange:e=>L(e.target.value)}),(0,l.jsx)("button",{type:"submit",className:"bg-gray-200 hover:bg-gray-300 px-3 py-2 rounded-r-md",children:(0,l.jsx)(g.default,{size:20})})]})}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("select",{className:"border border-gray-300 rounded-md px-3 py-2 text-sm",value:"".concat(F,"-").concat(Y),onChange:e=>{let[t,a]=e.target.value.split("-");X(t),K(a),U(1)},children:[(0,l.jsx)("option",{value:"orderNumber-asc",children:"순위순"}),(0,l.jsx)("option",{value:"createdAt-desc",children:"최신순"}),(0,l.jsx)("option",{value:"createdAt-asc",children:"오래된순"}),(0,l.jsx)("option",{value:"title-asc",children:"제목 오름차순"}),(0,l.jsx)("option",{value:"title-desc",children:"제목 내림차순"}),(0,l.jsx)("option",{value:"reviewRating-desc",children:"평점 높은순"}),(0,l.jsx)("option",{value:"reviewCount-desc",children:"리뷰 많은순"}),(0,l.jsx)("option",{value:"views-desc",children:"조회수 높은순"})]}),(0,l.jsxs)("select",{className:"border border-gray-300 rounded-md px-3 py-2 text-sm",value:Q,onChange:e=>{V(Number(e.target.value)),U(1)},children:[(0,l.jsx)("option",{value:"10",children:"10개씩"}),(0,l.jsx)("option",{value:"20",children:"20개씩"}),(0,l.jsx)("option",{value:"50",children:"50개씩"})]})]})]})}),(0,l.jsxs)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[s?(0,l.jsxs)("div",{className:"p-20 text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,l.jsx)("p",{className:"mt-3 text-gray-600",children:"콘텐츠를 불러오는 중..."})]}):c?(0,l.jsxs)("div",{className:"p-6 text-center text-red-600",children:[(0,l.jsx)("p",{children:c}),(0,l.jsx)("button",{onClick:$,className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"다시 시도"})]}):0===t.length?(0,l.jsx)("div",{className:"p-10 text-center text-gray-600",children:(0,l.jsx)("p",{children:"콘텐츠가 없습니다. 새 콘텐츠를 등록해보세요."})}):(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,l.jsx)("thead",{className:"bg-gray-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"정보"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"콘텐츠 타입"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상태"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"순위"}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,l.jsxs)("button",{className:"flex items-center",onClick:()=>ea("reviewRating"),children:["평점","reviewRating"===F&&(0,l.jsx)("span",{className:"ml-1",children:"asc"===Y?"↑":"↓"})]})}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,l.jsxs)("button",{className:"flex items-center",onClick:()=>ea("createdAt"),children:["등록일","createdAt"===F&&(0,l.jsx)("span",{className:"ml-1",children:"asc"===Y?"↑":"↓"})]})}),(0,l.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작업"})]})}),(0,l.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"flex-shrink-0 h-16 w-12 relative",children:e.coverImage?(0,l.jsx)(T(),{src:e.coverImage,alt:e.title,layout:"fill",objectFit:"cover",className:"rounded"}):(0,l.jsx)("div",{className:"h-full w-full bg-gray-200 rounded flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-gray-500 text-xs",children:"No Image"})})}),(0,l.jsxs)("div",{className:"ml-4",children:[(0,l.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,l.jsx)("div",{className:"text-sm text-gray-500",children:e.originalTitle}),e.featured&&(0,l.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:"대표 콘텐츠"})]})]})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-indigo-100 text-indigo-800",children:el(e.category)})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("방영 중"===er(e.status)?"bg-green-100 text-green-800":"완결"===er(e.status)?"bg-blue-100 text-blue-800":"개봉 예정"===er(e.status)?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:er(e.status)})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["#",e.orderNumber||t.indexOf(e)+1]}),(0,l.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,l.jsx)("button",{onClick:()=>ed(e._id,"up"),className:"text-blue-500 hover:text-blue-700 p-1",disabled:0===t.indexOf(e),title:"순위 올리기",children:(0,l.jsx)(m.default,{size:14,className:0===t.indexOf(e)?"text-gray-300":""})}),(0,l.jsx)("button",{onClick:()=>ed(e._id,"down"),className:"text-blue-500 hover:text-blue-700 p-1",disabled:t.indexOf(e)===t.length-1,title:"순위 내리기",children:(0,l.jsx)(p.default,{size:14,className:t.indexOf(e)===t.length-1?"text-gray-300":""})})]})]})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(f.default,{size:16,className:"text-yellow-400 mr-1"}),(0,l.jsx)("span",{className:"text-sm text-gray-900",children:e.reviewRating?e.reviewRating.toFixed(1):"-"}),(0,l.jsxs)("span",{className:"text-xs text-gray-500 ml-1",children:["(",e.reviewCount||0,")"]})]})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,w.default)(new Date(e.createdAt),"yyyy.MM.dd",{locale:k.default})}),(0,l.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,l.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,l.jsx)(d(),{href:"/".concat(e.category,"/").concat(e.slug),className:"text-indigo-600 hover:text-indigo-900",target:"_blank",rel:"noopener noreferrer",children:(0,l.jsx)(j.default,{size:18})}),(0,l.jsx)(d(),{href:"/admin/content/edit/".concat(e._id),className:"text-blue-600 hover:text-blue-900",children:(0,l.jsx)(b.default,{size:18})}),(0,l.jsx)("button",{className:"text-red-600 hover:text-red-900",onClick:()=>{et(e._id,e.title,e.contentType)},children:(0,l.jsx)(y.default,{size:18})})]})})]},e._id))})]})}),!s&&!c&&t.length>0&&(0,l.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"text-sm text-gray-700",children:[H,"개 중 ",(W-1)*Q+1,"-",Math.min(W*Q,H),"개 표시"]}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)("button",{className:"px-3 py-1 rounded border border-gray-300 disabled:opacity-50",onClick:()=>U(W-1),disabled:1===W,children:(0,l.jsx)(N.default,{size:18})}),Array.from({length:Math.min(5,q)},(e,t)=>{let a;return a=q<=5?t+1:W<=3?t+1:W>=q-2?q-4+t:W-2+t,(0,l.jsx)("button",{className:"px-3 py-1 rounded ".concat(W===a?"bg-blue-600 text-white":"border border-gray-300 hover:bg-gray-100"),onClick:()=>U(a),children:a},a)}),(0,l.jsx)("button",{className:"px-3 py-1 rounded border border-gray-300 disabled:opacity-50",onClick:()=>U(W+1),disabled:W===q,children:(0,l.jsx)(v.default,{size:18})})]})]})]})]}),S.visible&&(0,l.jsx)("div",{className:"fixed bottom-4 right-4 z-50 max-w-md animate-fade-in",children:(0,l.jsxs)("div",{className:"flex items-center p-4 rounded-lg border ".concat("success"===S.type?"bg-green-50 border-green-500":"error"===S.type?"bg-red-50 border-red-500":"warning"===S.type?"bg-yellow-50 border-yellow-500":"bg-blue-50 border-blue-500"," shadow-md"),children:[(0,l.jsx)("div",{className:"flex-grow ".concat("success"===S.type?"text-green-800":"error"===S.type?"text-red-800":"warning"===S.type?"text-yellow-800":"text-blue-800"),children:S.message}),(0,l.jsx)("button",{onClick:()=>O({visible:!1,message:"",type:""}),className:"ml-4 text-gray-500 hover:text-gray-700",children:(0,l.jsx)("span",{className:"text-xl",children:"\xd7"})})]})})]})},e=>{let t=(0,n.useRouter)(),[a,i]=(0,r.useState)(!0),{data:d,status:o}=(0,c.useSession)();(0,r.useEffect)(()=>{if("loading"===o)return;if(d&&d.user&&"admin"===d.user.role){i(!1);return}let e=x.default.get("token")||localStorage.getItem("token")||localStorage.getItem("adminToken");if(!e){t.push("/admin/login");return}m(e)},[t,d,o]);let m=async e=>{try{let a=await fetch("/api/auth/check-admin",{headers:{Authorization:"Bearer ".concat(e)}});(await a.json()).isAdmin?i(!1):t.push("/admin/login")}catch(e){t.push("/admin/login")}};return a?(0,l.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:(0,l.jsx)("div",{className:"p-8 bg-white rounded-lg shadow-md",children:(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("div",{className:"w-12 h-12 border-4 border-t-[#ff3e8e] rounded-full animate-spin"}),(0,l.jsx)("p",{className:"text-xl font-medium",children:"Loading admin panel..."})]})})}):(0,l.jsx)(s,{...e})})}},function(e){e.O(0,[1664,5089,6841,6079,3072,7083,2888,9774,179],function(){return e(e.s=35005)}),_N_E=e.O()}]);