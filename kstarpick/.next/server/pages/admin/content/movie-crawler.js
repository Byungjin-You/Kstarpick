"use strict";(()=>{var e={};e.id=8859,e.ids=[8859],e.modules={42238:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{config:()=>g,default:()=>m,getServerSideProps:()=>p,getStaticPaths:()=>h,getStaticProps:()=>x,reportWebVitals:()=>u,routeModule:()=>w,unstable_getServerProps:()=>j,unstable_getServerSideProps:()=>b,unstable_getStaticParams:()=>f,unstable_getStaticPaths:()=>v,unstable_getStaticProps:()=>y});var r=t(87093),i=t(35244),l=t(1323),n=t(65949),c=t(81928),o=t(51281),d=e([o]);o=(d.then?(await d)():d)[0];let m=(0,l.hoist)(o,"default"),x=(0,l.hoist)(o,"getStaticProps"),h=(0,l.hoist)(o,"getStaticPaths"),p=(0,l.hoist)(o,"getServerSideProps"),g=(0,l.hoist)(o,"config"),u=(0,l.hoist)(o,"reportWebVitals"),y=(0,l.hoist)(o,"unstable_getStaticProps"),v=(0,l.hoist)(o,"unstable_getStaticPaths"),f=(0,l.hoist)(o,"unstable_getStaticParams"),j=(0,l.hoist)(o,"unstable_getServerProps"),b=(0,l.hoist)(o,"unstable_getServerSideProps"),w=new r.PagesRouteModule({definition:{kind:i.RouteKind.PAGES,page:"/admin/content/movie-crawler",pathname:"/admin/content/movie-crawler",bundlePath:"",filename:""},components:{App:c.default,Document:n.default},userland:o});a()}catch(e){a(e)}})},23552:(e,s,t)=>{t.r(s),t.d(s,{default:()=>a});let a=(0,t(64370).default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},15595:(e,s,t)=>{t.r(s),t.d(s,{default:()=>a});let a=(0,t(64370).default)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["path",{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z",key:"nb9nel"}]])},34548:(e,s,t)=>{t.r(s),t.d(s,{default:()=>a});let a=(0,t(64370).default)("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]])},51281:(e,s,t)=>{t.a(e,async(e,a)=>{try{t.r(s),t.d(s,{default:()=>f,getServerSideProps:()=>j});var r=t(20997),i=t(16689),l=t(41649),n=t(79046),c=t(40220),o=t(3785),d=t(83364),m=t(34548),x=t(55809),h=t(23552),p=t(71952),g=t(15595);t(41664);var u=t(3590);t(88819),t(25675);var y=t(11163),v=e([u]);function f(){let{data:e,status:s}=(0,l.useSession)();(0,y.useRouter)();let[t,a]=(0,i.useState)("https://mydramalist.com/search?adv=titles&ty=77&co=3&so=newest&or=asc&page=1"),[v,f]=(0,i.useState)(!1),[j,b]=(0,i.useState)(null),[w,N]=(0,i.useState)([]),[S,k]=(0,i.useState)(null),[A,C]=(0,i.useState)({}),[R,P]=(0,i.useState)({}),[I,D]=(0,i.useState)(!1),[$,T]=(0,i.useState)(null),[O,q]=(0,i.useState)(!1),[E,M]=(0,i.useState)(0),[_,L]=(0,i.useState)({open:!1,movie:null}),z=(e,s="info")=>{u.toast[s](e,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},J=async()=>{try{let e;f(!0),b(null),N([]),z(`영화 목록 크롤링 중입니다...`,"info");let s=await fetch("/api/crawler/movie-stealth-crawler",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:t,mode:"list"})});try{e=await s.json()}catch(e){throw Error("서버 응답을 처리하는 중 오류가 발생했습니다.")}if(!s.ok)throw Error(e.message||"영화 목록을 가져오는데 실패했습니다.");e.data&&e.data.movies?(N(e.data.movies),k(e.data.nextPage),z(`${e.data.movies.length}개의 영화 정보를 가져왔습니다.`,"success")):(b("영화 정보가 없거나 형식이 올바르지 않습니다."),z("영화 정보 가져오기에 실패했습니다.","error"))}catch(e){b(e.message||"크롤링 중 오류가 발생했습니다."),z(`크롤링 오류: ${e.message}`,"error")}finally{f(!1)}},U=async()=>{if(!S){z("더 이상 다음 페이지가 없습니다.","info");return}try{let e;f(!0),b(null),z("다음 페이지를 크롤링 중입니다...","info");let s=await fetch("/api/crawler/movie-stealth-crawler",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:S,mode:"list"})});try{e=await s.json()}catch(e){throw Error("서버 응답을 처리하는 중 오류가 발생했습니다.")}if(!s.ok)throw Error(e.message||"영화 목록을 가져오는데 실패했습니다.");e.data&&e.data.movies?(N(s=>[...s,...e.data.movies]),k(e.data.nextPage),z(`${e.data.movies.length}개의 영화 정보를 추가로 가져왔습니다.`,"success")):(b("영화 정보가 없거나 형식이 올바르지 않습니다."),z("영화 정보 가져오기에 실패했습니다.","error"))}catch(e){b(e.message||"크롤링 중 오류가 발생했습니다."),z(`크롤링 오류: ${e.message}`,"error")}finally{f(!1)}},B=async e=>{try{let s;f(!0),b(null),z(`"${e.title}" 영화의 상세 정보를 가져오는 중...`,"info");let t=await fetch("/api/crawler/movie-stealth-crawler",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e.url,mode:"detail"})});try{s=await t.json()}catch(e){throw Error("서버 응답을 처리하는 중 오류가 발생했습니다.")}if(!t.ok)throw Error(s.message||"영화 상세 정보를 가져오는데 실패했습니다.");let a=s.data||{},r={...e,...a,mdlId:e.id,mdlUrl:e.url};return r.credits,r.cast,["originalTitle","releaseDate","duration","runtime","country","contentRating","genres","synopsis","summary","poster","coverImage","bannerImage"].forEach(e=>{r[e]}),!r.summary&&r.synopsis&&(r.summary=r.synopsis),!r.runtime&&r.duration&&(r.runtime=r.duration),!r.ageRating&&r.contentRating&&(r.ageRating=r.contentRating),!r.coverImage&&r.poster&&(r.coverImage=r.poster),r.bannerImage||(r.bannerImage=r.coverImage||r.poster),Array.isArray(r.genres)||(r.genres=[]),Array.isArray(r.tags)||(r.tags=[]),Array.isArray(r.watchProviders)||(r.watchProviders=[]),r.credits&&(("object"!=typeof r.cast||Array.isArray(r.cast))&&(r.cast={mainRoles:[],supportRoles:[]}),Array.isArray(r.credits.mainCast)&&(r.cast.mainRoles=r.credits.mainCast),Array.isArray(r.credits.supportCast)&&(r.cast.supportRoles=r.credits.supportCast)),T(r),L({open:!0,movie:r}),z(`"${e.title}" 영화의 상세 정보를 가져왔습니다.`,"success"),r}catch(e){return b(e.message||"상세 정보 크롤링 중 오류가 발생했습니다."),z(`크롤링 오류: ${e.message}`,"error"),null}finally{f(!1)}},F=async e=>{if(!e){z("저장할 영화 데이터가 없습니다.","error");return}try{let s;if(P(s=>({...s,[e.mdlId]:"saving"})),e.credits){if(Array.isArray(e.credits.mainCast)||Array.isArray(e.credits.supportCast)){let s=Array.isArray(e.credits.mainCast)?e.credits.mainCast:[],t=Array.isArray(e.credits.supportCast)?e.credits.supportCast:[],a=new Set,r=[...s.filter(e=>!!e&&!!e.name&&!a.has(e.name)&&(a.add(e.name),!0)).map((e,s)=>({name:e.name||"N/A",role:e.role||(e.character?e.character:"Main Role"),image:e.image||"",order:s})),...t.filter(e=>!!e&&!!e.name&&!a.has(e.name)&&(a.add(e.name),!0)).map((e,t)=>({name:e.name||"N/A",role:e.role||(e.character?e.character:"Support Role"),image:e.image||"",order:s.length+t}))];e.cast=r}}else if(e.cast&&"object"==typeof e.cast&&!Array.isArray(e.cast)){let s=Array.isArray(e.cast.mainRoles)?e.cast.mainRoles:[],t=Array.isArray(e.cast.supportRoles)?e.cast.supportRoles:[],a=new Set,r=[...s.filter(e=>!!e&&!!e.name&&!a.has(e.name)&&(a.add(e.name),!0)).map((e,s)=>({name:e.name||"N/A",role:e.role||"Main Role",image:e.image||"",order:s})),...t.filter(e=>!!e&&!!e.name&&!a.has(e.name)&&(a.add(e.name),!0)).map((e,t)=>({name:e.name||"N/A",role:e.role||"Support Role",image:e.image||"",order:s.length+t}))];e.cast=r}let t={...e,category:"movie",status:e.status||"completed",originalTitle:e.originalTitle||"",summary:e.synopsis||e.summary||"",content:e.synopsis||e.content||e.summary||"",releaseDate:e.releaseDate||null,director:e.director||"",runtime:e.duration||e.runtime||"",country:e.country||"South Korea",ageRating:e.contentRating||"",genres:Array.isArray(e.genres)?e.genres:[],tags:Array.isArray(e.tags)?e.tags:[],coverImage:e.poster||e.coverImage||"/images/placeholder-tvfilm.svg",bannerImage:e.bannerImage||e.poster||"/images/placeholder-tvfilm.svg",watchProviders:Array.isArray(e.watchProviders)?e.watchProviders:[],createdAt:new Date,updatedAt:new Date},a=localStorage.getItem("token")||localStorage.getItem("adminToken"),r=await fetch("/api/dramas",{method:"POST",headers:{"Content-Type":"application/json",Authorization:a?`Bearer ${a}`:""},body:JSON.stringify(t)});try{s=await r.json()}catch(e){throw Error("서버 응답을 처리하는 중 오류가 발생했습니다.")}if(!r.ok)throw Error(s.message||"영화 저장에 실패했습니다.");return P(s=>({...s,[e.mdlId]:"saved"})),z(`"${e.title}" 영화를 저장했습니다.`,"success"),s.data}catch(s){return P(s=>({...s,[e.mdlId]:"error"})),z(`저장 오류: ${s.message}`,"error"),null}},W=async()=>{let e=Object.keys(A).filter(e=>A[e]);if(0===e.length){z("저장할 영화를 선택해주세요.","warning");return}let s=0,t=0;for(let a of e){let e=w.find(e=>e.id===a);if(e)try{await B(e),await F($),s++}catch(e){t++}}z(`${s}개 영화 저장 완료, ${t}개 실패`,s>0?"success":"warning")},G=e=>{C(s=>({...s,[e]:!s[e]}))},H=e=>{let s=R[e];return"saving"===s?r.jsx(c.default,{className:"animate-spin h-4 w-4 text-blue-500"}):"saved"===s?r.jsx(o.default,{className:"h-4 w-4 text-green-500"}):"error"===s?r.jsx(d.default,{className:"h-4 w-4 text-red-500"}):null},K=async(e,s)=>{if(!e||!s){z("영화 ID와 URL이 필요합니다.","error");return}try{let t;q(!0),z("리뷰를 크롤링 중입니다...","info");let a=await fetch("/api/crawler/movie-reviews-stealth-crawler",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:`${s}/reviews`,dramaId:e})});try{t=await a.json()}catch(e){throw Error("서버 응답을 처리하는 중 오류가 발생했습니다.")}if(!a.ok)throw Error(t.message||"리뷰를 가져오는데 실패했습니다.");t.data&&t.data.reviewCount?(M(t.data.reviewCount),L(e=>({...e,movie:{...e.movie,reviewCount:t.data.reviewCount,reviewRating:t.data.reviewRating,ratingDistribution:t.data.ratingDistribution}})),z(`${t.data.reviewCount}개의 리뷰를 크롤링했습니다. 평균 평점: ${t.data.reviewRating?.toFixed(1)}`,"success")):z("리뷰를 크롤링 했으나 결과가 없습니다.","warning")}catch(e){z(`리뷰 크롤링 오류: ${e.message}`,"error")}finally{q(!1)}};return(0,r.jsxs)(n.default,{children:[(0,r.jsxs)("div",{className:"container px-4 py-6 mx-auto",children:[r.jsx("h1",{className:"text-2xl font-bold mb-6",children:"영화 크롤러"}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[r.jsx("h2",{className:"text-lg font-semibold mb-4",children:"MyDramaList 영화 크롤링"}),(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-3 mb-4",children:[(0,r.jsxs)("div",{className:"flex-grow",children:[r.jsx("label",{htmlFor:"url",className:"block text-sm font-medium text-gray-700 mb-1",children:"크롤링 URL"}),r.jsx("input",{type:"text",id:"url",value:t,onChange:e=>{a(e.target.value)},className:"block w-full border border-gray-300 rounded px-3 py-2 text-sm",placeholder:"https://mydramalist.com/search?adv=titles&ty=77&co=3&so=newest&or=asc&page=1"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"MyDramaList 영화 검색 결과 페이지 URL을 입력하세요. (ty=77은 영화를 의미)"})]}),r.jsx("div",{className:"flex items-end",children:(0,r.jsxs)("button",{onClick:J,disabled:v,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded flex items-center gap-2 whitespace-nowrap disabled:bg-blue-400",children:[v?r.jsx(c.default,{className:"animate-spin h-4 w-4"}):r.jsx(h.default,{className:"h-4 w-4"}),"스텔스 크롤링"]})})]}),j&&r.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-2 rounded text-sm mb-4",children:j})]}),w.length>0&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold",children:["크롤링된 영화 목록 (",w.length,"개)"]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("button",{onClick:()=>{if(Object.keys(A).length===w.length&&Object.values(A).every(e=>e))C({});else{let e={};w.forEach(s=>{e[s.id]=!0}),C(e)}},className:"bg-gray-100 hover:bg-gray-200 text-gray-800 px-3 py-1 rounded text-sm flex items-center gap-1",children:[r.jsx(o.default,{className:"h-4 w-4"}),"전체 선택/해제"]}),(0,r.jsxs)("button",{onClick:W,disabled:v||0===Object.keys(A).filter(e=>A[e]).length,className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm flex items-center gap-1 disabled:bg-green-400",children:[r.jsx(x.default,{className:"h-4 w-4"}),"선택 저장"]}),S&&(0,r.jsxs)("button",{onClick:U,disabled:v,className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm flex items-center gap-1 disabled:bg-blue-400",children:[v?r.jsx(c.default,{className:"animate-spin h-4 w-4"}):r.jsx(p.default,{className:"h-4 w-4"}),"다음 페이지"]})]})]}),r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-10",children:"선택"}),r.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-14",children:"이미지"}),r.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"제목"}),r.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"평점"}),r.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"연도"}),r.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"상태"}),r.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-32",children:"작업"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:r.jsx("input",{type:"checkbox",checked:A[e.id]||!1,onChange:()=>G(e.id),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"})}),r.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.image?r.jsx("div",{className:"w-10 h-14 relative overflow-hidden rounded",children:r.jsx("img",{src:e.image,alt:e.title,className:"object-cover w-full h-full",onError:e=>{e.target.src="/images/placeholder-poster.png"}})}):r.jsx("div",{className:"w-10 h-14 bg-gray-200 flex items-center justify-center rounded",children:r.jsx("span",{className:"text-xs text-gray-500",children:"없음"})})}),(0,r.jsxs)("td",{className:"px-4 py-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.title}),r.jsx("div",{className:"text-xs text-gray-500",children:e.id}),r.jsx("div",{className:"text-xs text-blue-500 hover:underline",children:(0,r.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1",children:[r.jsx(g.default,{className:"h-3 w-3"}),"MDL"]})})]}),r.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:e.rating?r.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:e.rating}):r.jsx("span",{className:"text-gray-400 text-xs",children:"-"})}),r.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:e.year||"-"}),r.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:H(e.id)||r.jsx("span",{className:"text-xs text-gray-400",children:"대기중"})}),r.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,r.jsxs)("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>B(e),disabled:v,className:"text-blue-600 hover:text-blue-900 text-xs flex items-center gap-1",children:"상세정보"}),r.jsx("button",{onClick:async()=>{await B(e),$&&await F($)},disabled:v||"saving"===R[e.id]||"saved"===R[e.id],className:"text-green-600 hover:text-green-900 text-xs flex items-center gap-1",children:"저장"})]})})]},e.id))})]})})]})]}),_.open&&_.movie?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-auto",children:r.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[r.jsx("h2",{className:"text-xl font-bold",children:_.movie.title}),r.jsx("button",{onClick:()=>L({open:!1,movie:null}),className:"text-gray-500 hover:text-gray-700",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"md:col-span-1",children:[_.movie.poster?r.jsx("div",{className:"relative w-full aspect-[2/3] rounded overflow-hidden",children:r.jsx("img",{src:_.movie.poster,alt:_.movie.title,className:"object-cover w-full h-full"})}):r.jsx("div",{className:"w-full aspect-[2/3] bg-gray-200 flex items-center justify-center rounded",children:r.jsx("span",{className:"text-gray-400",children:"이미지 없음"})}),(0,r.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-500",children:"평점:"}),r.jsx("span",{className:"font-semibold",children:_.movie.rating||"정보 없음"})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-500",children:"연도:"}),r.jsx("span",{className:"font-semibold",children:_.movie.year||"정보 없음"})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-500",children:"국가:"}),r.jsx("span",{className:"font-semibold",children:_.movie.country||"정보 없음"})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-500",children:"리뷰:"}),r.jsx("span",{className:"font-semibold",children:_.movie.reviewCount||"0"})]})]})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"상세 정보"}),_.movie.originalTitle&&(0,r.jsxs)("div",{className:"mb-3",children:[r.jsx("span",{className:"text-gray-500 text-sm",children:"원제: "}),r.jsx("span",{children:_.movie.originalTitle})]}),_.movie.genres&&_.movie.genres.length>0&&(0,r.jsxs)("div",{className:"mb-3",children:[r.jsx("span",{className:"text-gray-500 text-sm",children:"장르: "}),r.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:_.movie.genres.map((e,s)=>r.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded",children:e},s))})]}),_.movie.synopsis&&(0,r.jsxs)("div",{className:"mb-3",children:[r.jsx("span",{className:"text-gray-500 text-sm",children:"줄거리: "}),r.jsx("p",{className:"text-sm mt-1 text-gray-700",children:_.movie.synopsis})]}),_.movie.cast&&_.movie.cast.mainRoles&&_.movie.cast.mainRoles.length>0&&(0,r.jsxs)("div",{className:"mb-3",children:[r.jsx("span",{className:"text-gray-500 text-sm",children:"주요 출연진: "}),r.jsx("ul",{className:"list-disc list-inside text-sm mt-1",children:_.movie.cast.mainRoles.map((e,s)=>(0,r.jsxs)("li",{children:[e.name," ",e.role?` - ${e.role}`:""]},s))})]}),_.movie.releaseDate&&(0,r.jsxs)("div",{className:"mb-3",children:[r.jsx("span",{className:"text-gray-500 text-sm",children:"개봉일: "}),r.jsx("span",{children:_.movie.releaseDate})]}),_.movie.duration&&(0,r.jsxs)("div",{className:"mb-3",children:[r.jsx("span",{className:"text-gray-500 text-sm",children:"상영 시간: "}),r.jsx("span",{children:_.movie.duration})]}),_.movie.contentRating&&(0,r.jsxs)("div",{className:"mb-3",children:[r.jsx("span",{className:"text-gray-500 text-sm",children:"등급: "}),r.jsx("span",{children:_.movie.contentRating})]})]})]}),(0,r.jsxs)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"리뷰 정보"}),_.movie.reviewCount>0?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-gray-500",children:"평균 평점:"}),r.jsx("span",{className:"font-semibold",children:_.movie.reviewRating?.toFixed(1)||"0"})]}),(0,r.jsxs)("div",{children:[r.jsx("span",{className:"text-gray-500",children:"평점 분포:"}),r.jsx("div",{className:"flex mt-1 gap-1 h-24",children:_.movie.ratingDistribution&&_.movie.ratingDistribution.map((e,s)=>(0,r.jsxs)("div",{className:"flex flex-col items-center w-8",children:[r.jsx("div",{className:"flex-grow w-full bg-gray-100 relative",children:r.jsx("div",{className:"absolute bottom-0 w-full bg-blue-500",style:{height:`${e>0?Math.max(e/Math.max(..._.movie.ratingDistribution)*100,10):0}%`}})}),r.jsx("span",{className:"text-xs mt-1",children:s+1})]},s))})]})]}):r.jsx("div",{className:"text-gray-500",children:"아직 리뷰 정보가 없습니다. 리뷰를 크롤링하세요."})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[r.jsx("button",{onClick:()=>L({open:!1,movie:null}),className:"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50 text-sm",children:"닫기"}),(0,r.jsxs)("button",{onClick:()=>K(_.movie._id,_.movie.url),disabled:O,className:"px-4 py-2 bg-purple-600 rounded text-white hover:bg-purple-700 text-sm flex items-center gap-1 disabled:bg-purple-400",children:[O?r.jsx(c.default,{className:"animate-spin h-4 w-4"}):r.jsx(m.default,{className:"h-4 w-4"}),"리뷰 크롤링"]}),(0,r.jsxs)("button",{onClick:()=>F(_.movie),disabled:v||"saving"===R[_.movie.mdlId]||"saved"===R[_.movie.mdlId],className:"px-4 py-2 bg-blue-600 rounded text-white hover:bg-blue-700 text-sm flex items-center gap-1 disabled:bg-blue-400",children:["saving"===R[_.movie.mdlId]?r.jsx(c.default,{className:"animate-spin h-4 w-4"}):r.jsx(x.default,{className:"h-4 w-4"}),"데이터베이스에 저장"]})]})]})})}):null,r.jsx(u.ToastContainer,{})]})}async function j(e){let s=await (0,l.getSession)(e);return s&&"admin"===s.user.role?{props:{session:s}}:{redirect:{destination:"/admin/login",permanent:!1}}}u=(v.then?(await v)():v)[0],a()}catch(e){a(e)}})},41649:e=>{e.exports=require("next-auth/react")},62785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},40968:e=>{e.exports=require("next/head")},16689:e=>{e.exports=require("react")},66405:e=>{e.exports=require("react-dom")},20997:e=>{e.exports=require("react/jsx-runtime")},99816:e=>{e.exports=require("styled-jsx/style")},92048:e=>{e.exports=require("fs")},55315:e=>{e.exports=require("path")},76162:e=>{e.exports=require("stream")},71568:e=>{e.exports=require("zlib")},3590:e=>{e.exports=import("react-toastify")}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[3393,1859,6859,8559,6870,8505,6014],()=>t(42238));module.exports=a})();