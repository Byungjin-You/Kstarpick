"use strict";(()=>{var e={};e.id=7838,e.ids=[7838],e.modules={38013:e=>{e.exports=require("mongodb")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},56249:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"hoist",{enumerable:!0,get:function(){return function e(t,n){return n in t?t[n]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,n)):"function"==typeof t&&"default"===n?t:void 0}}})},34310:(e,t,n)=>{n.r(t),n.d(t,{config:()=>l,default:()=>d,routeModule:()=>p});var o={};n.r(o),n.d(o,{default:()=>c});var i=n(71802),r=n(47153),a=n(56249),s=n(38013);let u="mongodb://kstarpick:zpdltmxkvlr0%212@kstarpick-mongodb-production.cluster-cjquemysifmm.ap-northeast-2.docdb.amazonaws.com:27017/kstarpick?retryWrites=false&authSource=admin&authMechanism=SCRAM-SHA-1";if(!u)throw Error("MONGODB_URI environment variable is not defined");async function c(e,t){let n;if("GET"!==e.method)return t.status(405).json({message:"Method not allowed"});try{n=new s.MongoClient(u,{retryWrites:!1,connectTimeoutMS:3e4,socketTimeoutMS:45e3,serverSelectionTimeoutMS:3e4,authSource:"admin",authMechanism:"SCRAM-SHA-1"}),await n.connect();let o=n.db("kstarpick"),{page:i=1,limit:r=12,sort:a="publishedAt",order:c="desc"}=e.query,d=parseInt(i),l=parseInt(r),p=(d-1)*l,m={$and:[{category:{$regex:"^movie$",$options:"i"}},{$or:[{title:{$exists:!0,$ne:"",$ne:null}},{title:{$exists:!1}}]},{$or:[{content:{$exists:!1}},{content:{$ne:"<p>상세 기사를 가져오는 중 오류가 발생했습니다. 원본 페이지를 방문해 주세요.</p>"}},{content:{$not:{$regex:"^<p>상세 기사를 가져오는 중 오류가 발생했습니다"}}}]}]},f=await o.collection("news").countDocuments(m),P=await o.collection("news").find(m).sort({[a]:"asc"===c?1:-1}).skip(p).limit(l).toArray(),h=Math.ceil(f/l);return t.status(200).json({success:!0,data:P,pagination:{total:f,page:d,limit:l,totalPages:h,hasNextPage:d<h,hasPrevPage:d>1}})}catch(e){return t.status(500).json({success:!1,message:e.message})}finally{n&&await n.close()}}let d=(0,a.hoist)(o,"default"),l=(0,a.hoist)(o,"config"),p=new i.PagesAPIRouteModule({definition:{kind:r.RouteKind.PAGES_API,page:"/api/news/movie",pathname:"/api/news/movie",bundlePath:"",filename:""},userland:o})},47153:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouteKind",{enumerable:!0,get:function(){return n}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(n||(n={}))},71802:(e,t,n)=>{e.exports=n(20145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var n=t(t.s=34310);module.exports=n})();