"use strict";(()=>{var e={};e.id=7838,e.ids=[7838],e.modules={38013:e=>{e.exports=require("mongodb")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},56249:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"hoist",{enumerable:!0,get:function(){return function e(t,n){return n in t?t[n]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,n)):"function"==typeof t&&"default"===n?t:void 0}}})},34310:(e,t,n)=>{n.r(t),n.d(t,{config:()=>d,default:()=>c,routeModule:()=>l});var o={};n.r(o),n.d(o,{default:()=>u});var i=n(71802),a=n(47153),r=n(56249),s=n(38013);async function u(e,t){let n;if("GET"!==e.method)return t.status(405).json({message:"Method not allowed"});try{n=new s.MongoClient("mongodb://kstarpick:zpdltmxkvlr0%212@kstarpick-mongodb-production.cluster-cjquemysifmm.ap-northeast-2.docdb.amazonaws.com:27017/kstarpick?retryWrites=false&authSource=admin&authMechanism=SCRAM-SHA-1",{retryWrites:!1,connectTimeoutMS:3e4,socketTimeoutMS:45e3,serverSelectionTimeoutMS:3e4,authSource:"admin",authMechanism:"SCRAM-SHA-1"}),await n.connect();let o=n.db("kstarpick"),{page:i=1,limit:a=12,sort:r="createdAt",order:u="desc"}=e.query,c=parseInt(i),d=parseInt(a),l=(c-1)*d,p={$and:[{category:{$regex:"^movie$",$options:"i"}},{$or:[{title:{$exists:!0,$ne:"",$ne:null}},{title:{$exists:!1}}]},{$or:[{content:{$exists:!1}},{content:{$ne:"<p>상세 기사를 가져오는 중 오류가 발생했습니다. 원본 페이지를 방문해 주세요.</p>"}},{content:{$not:{$regex:"^<p>상세 기사를 가져오는 중 오류가 발생했습니다"}}}]}]},m=await o.collection("news").countDocuments(p),P=await o.collection("news").find(p).sort({[r]:"asc"===u?1:-1}).skip(l).limit(d).toArray(),f=Math.ceil(m/d);return t.status(200).json({success:!0,data:P,pagination:{total:m,page:c,limit:d,totalPages:f,hasNextPage:c<f,hasPrevPage:c>1}})}catch(e){return t.status(500).json({success:!1,message:e.message})}finally{n&&await n.close()}}let c=(0,r.hoist)(o,"default"),d=(0,r.hoist)(o,"config"),l=new i.PagesAPIRouteModule({definition:{kind:a.RouteKind.PAGES_API,page:"/api/news/movie",pathname:"/api/news/movie",bundlePath:"",filename:""},userland:o})},47153:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouteKind",{enumerable:!0,get:function(){return n}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(n||(n={}))},71802:(e,t,n)=>{e.exports=n(20145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var n=t(t.s=34310);module.exports=n})();