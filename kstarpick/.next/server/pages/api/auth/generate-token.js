"use strict";(()=>{var e={};e.id=8582,e.ids=[8582],e.modules={25142:e=>{e.exports=require("dotenv")},99344:e=>{e.exports=require("jsonwebtoken")},38013:e=>{e.exports=require("mongodb")},11185:e=>{e.exports=require("mongoose")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},92048:e=>{e.exports=require("fs")},55315:e=>{e.exports=require("path")},56249:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"hoist",{enumerable:!0,get:function(){return function e(t,n){return n in t?t[n]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,n)):"function"==typeof t&&"default"===n?t:void 0}}})},68197:(e,t,n)=>{n.r(t),n.d(t,{config:()=>u,default:()=>s,routeModule:()=>l});var o={};n.r(o),n.d(o,{default:()=>c});var a=n(71802),r=n(47153),i=n(56249);async function c(e,t){return t.status(403).json({success:!1,message:"개발 환경에서만 사용 가능한 API입니다."})}n(35968),n(99344),n(44756),n(81075);let s=(0,i.hoist)(o,"default"),u=(0,i.hoist)(o,"config"),l=new a.PagesAPIRouteModule({definition:{kind:r.RouteKind.PAGES_API,page:"/api/auth/generate-token",pathname:"/api/auth/generate-token",bundlePath:"",filename:""},userland:o})},44756:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var o=n(11185),a=n.n(o);n(25142).config({path:".env.production"});let r="mongodb://kstarpick:zpdltmxkvlr0%212@kstarpick-mongodb-production.cluster-cjquemysifmm.ap-northeast-2.docdb.amazonaws.com:27017/kstarpick?retryWrites=false&authSource=admin&authMechanism=SCRAM-SHA-1";r||(r="mongodb://kstarpick:zpdltmxkvlr0%212@kstarpick-mongodb-production.cluster-cjquemysifmm.ap-northeast-2.docdb.amazonaws.com:27017/kstarpick?authSource=admin"),r.includes("localhost")||(r.includes("mongodb://")&&!r.includes("authSource=")&&(r.includes("?")?r+="&authSource=admin":r+="?authSource=admin"),!r.includes("docdb.amazonaws.com")||r.includes("authMechanism=")||(r.includes("?")?r+="&authMechanism=SCRAM-SHA-1":r+="?authMechanism=SCRAM-SHA-1"));let i=r.includes("localhost")||r.includes("127.0.0.1"),c=global.mongoose;async function s(){if(c.conn&&1===a().connection.readyState)return c.conn;if(0===a().connection.readyState||3===a().connection.readyState){c.conn=null,c.promise=null;try{await a().connection.close()}catch(e){}}if(!c.promise){let e={maxPoolSize:10,serverSelectionTimeoutMS:1e4,socketTimeoutMS:45e3,connectTimeoutMS:1e4,family:4,heartbeatFrequencyMS:1e4};i||(r.includes("docdb.amazonaws.com")&&(e.tls=!1,e.tlsAllowInvalidCertificates=!0,e.tlsAllowInvalidHostnames=!0),e.authSource="admin"),c.promise=a().connect(r,e).then(e=>(e.connection.on("error",e=>{c.conn=null,c.promise=null,setTimeout(()=>{s().catch(e=>console.error("[Mongoose] Reconnection failed:",e))},5e3)}),e.connection.on("disconnected",()=>{c.conn=null,c.promise=null,setTimeout(()=>{s().catch(e=>console.error("[Mongoose] Reconnection failed:",e))},3e3)}),e)).catch(e=>{throw c.promise=null,e})}try{return c.conn=await c.promise,c.conn}catch(e){throw c.promise=null,e}}c||(c=global.mongoose={conn:null,promise:null});let u=s},81075:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var o=n(11185),a=n.n(o);let r=new(a()).Schema({name:{type:String,required:[!0,"Please provide a name"],maxlength:[60,"Name cannot be more than 60 characters"]},email:{type:String,required:[!0,"Please provide an email"],unique:!0},password:{type:String,required:[!0,"Please provide a password"]},image:{type:String,default:"/images/default-avatar.png"},role:{type:String,enum:["user","admin","editor"],default:"user"},likes:{type:[{contentId:{type:a().Schema.Types.ObjectId,required:!0},contentType:{type:String,required:!0},timestamp:{type:Date,default:Date.now}}],default:[]},dislikes:{type:[{contentId:{type:a().Schema.Types.ObjectId,required:!0},contentType:{type:String,required:!0},timestamp:{type:Date,default:Date.now}}],default:[]},bookmarks:{type:[{contentId:{type:a().Schema.Types.ObjectId,required:!0},contentType:{type:String,required:!0},timestamp:{type:Date,default:Date.now}}],default:[]},createdAt:{type:Date,default:Date.now},updatedAt:{type:Date,default:Date.now}}),i=a().models.User||a().model("User",r)},35968:(e,t,n)=>{let o;n.r(t),n.d(t,{connectToDatabase:()=>u,dbConnect:()=>l,default:()=>d});var a=n(38013),r=n(92048),i=n.n(r),c=n(55315),s=n.n(c);{let e=n(25142),t=s().resolve(process.cwd(),".env.production");i().existsSync(t)&&e.config({path:t}).error}async function u(){try{let e=await o,t=e.db("kstarpick");return{client:e,db:t}}catch(e){throw e}}o=new a.MongoClient("mongodb://kstarpick:zpdltmxkvlr0%212@kstarpick-mongodb-production.cluster-cjquemysifmm.ap-northeast-2.docdb.amazonaws.com:27017/kstarpick?retryWrites=false&authSource=admin&authMechanism=SCRAM-SHA-1",{tls:!1,tlsAllowInvalidCertificates:!0,tlsAllowInvalidHostnames:!0,retryWrites:!1,maxPoolSize:50,serverSelectionTimeoutMS:5e3,socketTimeoutMS:45e3,connectTimeoutMS:1e4,heartbeatFrequencyMS:1e4,maxIdleTimeMS:3e4}).connect();let l=u,d=o},47153:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouteKind",{enumerable:!0,get:function(){return n}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(n||(n={}))},71802:(e,t,n)=>{e.exports=n(20145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var n=t(t.s=68197);module.exports=n})();