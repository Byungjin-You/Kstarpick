"use strict";(()=>{var e={};e.id=3748,e.ids=[3748],e.modules={98432:e=>{e.exports=require("bcryptjs")},25142:e=>{e.exports=require("dotenv")},38013:e=>{e.exports=require("mongodb")},73227:e=>{e.exports=require("next-auth")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},92048:e=>{e.exports=require("fs")},55315:e=>{e.exports=require("path")},56249:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"hoist",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},64828:(e,t,r)=>{r.r(t),r.d(t,{config:()=>u,default:()=>s,routeModule:()=>l});var n=r(71802),a=r(47153),o=r(56249),i=r(69097);let s=(0,o.hoist)(i,"default"),u=(0,o.hoist)(i,"config"),l=new n.PagesAPIRouteModule({definition:{kind:a.RouteKind.PAGES_API,page:"/api/auth/[...nextauth]",pathname:"/api/auth/[...nextauth]",bundlePath:"",filename:""},userland:i})},69097:(e,t,r)=>{r.r(t),r.d(t,{authOptions:()=>c,default:()=>d});var n=r(73227),a=r.n(n);let o=require("next-auth/providers/credentials");var i=r.n(o),s=r(35968),u=r(98432),l=r.n(u);let c={providers:[i()({name:"Credentials",credentials:{email:{label:"Email",type:"text"},password:{label:"Password",type:"password"}},async authorize(e){try{let{db:t}=await (0,s.connectToDatabase)(),r=await t.collection("users").findOne({email:e.email});if(!r||!await l().compare(e.password,r.password))return null;return{id:r._id.toString(),name:r.name,email:r.email,role:r.role}}catch(e){return null}}})],session:{strategy:"jwt",maxAge:2592e3},callbacks:{jwt:async({token:e,user:t})=>(t&&(e.id=t.id,e.role=t.role),e),session:async({session:e,token:t})=>(t&&(e.user.id=t.id,e.user.role=t.role),e)},pages:{signIn:"/auth/signin",error:"/auth/error"},debug:!1,secret:"kstarpick_nextauth_secret_key_2024_production"},d=a()(c)},35968:(e,t,r)=>{let n;r.r(t),r.d(t,{connectToDatabase:()=>l,dbConnect:()=>c,default:()=>d});var a=r(38013),o=r(92048),i=r.n(o),s=r(55315),u=r.n(s);{let e=r(25142),t=u().resolve(process.cwd(),".env.production");i().existsSync(t)&&e.config({path:t}).error}async function l(){try{let e=await n,t=e.db("kstarpick");return{client:e,db:t}}catch(e){throw e}}n=new a.MongoClient("mongodb://kstarpick:zpdltmxkvlr0%212@kstarpick-mongodb-production.cluster-cjquemysifmm.ap-northeast-2.docdb.amazonaws.com:27017/kstarpick?retryWrites=false&authSource=admin&authMechanism=SCRAM-SHA-1",{tls:!1,tlsAllowInvalidCertificates:!0,tlsAllowInvalidHostnames:!0,retryWrites:!1,maxPoolSize:50,serverSelectionTimeoutMS:5e3,socketTimeoutMS:45e3,connectTimeoutMS:1e4,heartbeatFrequencyMS:1e4,maxIdleTimeMS:3e4}).connect();let c=l,d=n},47153:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouteKind",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},71802:(e,t,r)=>{e.exports=r(20145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=t(t.s=64828);module.exports=r})();