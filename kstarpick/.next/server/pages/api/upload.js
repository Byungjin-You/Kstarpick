"use strict";(()=>{var e={};e.id=5039,e.ids=[5039],e.modules={41649:e=>{e.exports=require("next-auth/react")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},92048:e=>{e.exports=require("fs")},55315:e=>{e.exports=require("path")},36705:e=>{e.exports=import("formidable")},56249:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"hoist",{enumerable:!0,get:function(){return function e(t,s){return s in t?t[s]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,s)):"function"==typeof t&&"default"===s?t:void 0}}})},91014:(e,t,s)=>{s.a(e,async(e,i)=>{try{s.r(t),s.d(t,{config:()=>c,default:()=>l,routeModule:()=>p});var a=s(71802),n=s(47153),r=s(56249),u=s(77170),o=e([u]);u=(o.then?(await o)():o)[0];let l=(0,r.hoist)(u,"default"),c=(0,r.hoist)(u,"config"),p=new a.PagesAPIRouteModule({definition:{kind:n.RouteKind.PAGES_API,page:"/api/upload",pathname:"/api/upload",bundlePath:"",filename:""},userland:u});i()}catch(e){i(e)}})},77170:(e,t,s)=>{s.a(e,async(e,i)=>{try{s.r(t),s.d(t,{config:()=>d,default:()=>p});var a=s(36705),n=s(92048),r=s.n(n),u=s(55315),o=s.n(u),l=s(41649),c=e([a]);a=(c.then?(await c)():c)[0];let d={api:{bodyParser:!1}};async function p(e,t){if("POST"!==e.method)return t.status(405).json({success:!1,message:"허용되지 않는 메소드입니다."});try{let s=await (0,l.getSession)({req:e});if(!s||!s.user)return t.status(401).json({success:!1,message:"인증이 필요합니다."});let i={maxFiles:1,maxFileSize:5242880,keepExtensions:!0,multiples:!1},[n,u]=await new Promise((t,s)=>{(0,a.default)(i).parse(e,(e,i,a)=>{if(e){s(e);return}t([i,a])})}),c=u.file;if(!c||0===c.length)return t.status(400).json({success:!1,message:"이미지 파일이 필요합니다."});let p=c[0];if(!["image/jpeg","image/png","image/webp","image/gif"].includes(p.mimetype))return t.status(400).json({success:!1,message:"지원되지 않는 파일 형식입니다. JPEG, PNG, WebP, GIF만 허용됩니다."});try{let e=o().join(process.cwd(),"public/uploads/tvfilm");r().existsSync(e)||r().mkdirSync(e,{recursive:!0});let s=`${Date.now()}-${p.originalFilename}`,i=o().join(e,s);return r().copyFileSync(p.filepath,i),t.status(200).json({success:!0,message:"이미지가 성공적으로 업로드되었습니다.",fileUrl:`/uploads/tvfilm/${s}`,data:{url:`/uploads/tvfilm/${s}`,fileName:s,originalName:p.originalFilename,size:p.size}})}catch(e){return t.status(500).json({success:!1,message:"파일 저장 중 오류가 발생했습니다."})}}catch(e){return t.status(500).json({success:!1,message:"서버 오류가 발생했습니다."})}}i()}catch(e){i(e)}})},47153:(e,t)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouteKind",{enumerable:!0,get:function(){return s}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(s||(s={}))},71802:(e,t,s)=>{e.exports=s(20145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var s=t(t.s=91014);module.exports=s})();