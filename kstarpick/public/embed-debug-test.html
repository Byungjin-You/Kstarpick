<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì„ë² ë“œ ë””ë²„ê·¸ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 2px solid #ddd;
            border-radius: 8px;
        }
        .log {
            background: #f5f5f5;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
        }
        .status {
            padding: 5px 10px;
            border-radius: 4px;
            margin: 5px;
            display: inline-block;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>ğŸ” ì„ë² ë“œ ë¡œë”© ë””ë²„ê·¸ í…ŒìŠ¤íŠ¸</h1>
    
    <div id="status-log" class="log">
        <strong>ë¡œë”© ìƒíƒœ ë¡œê·¸:</strong><br>
        <span id="log-content">í…ŒìŠ¤íŠ¸ ì‹œì‘...</span>
    </div>

    <!-- 1. Instagram ì„ë² ë“œ í…ŒìŠ¤íŠ¸ -->
    <div class="test-section">
        <h2>ğŸ“¸ Instagram ì„ë² ë“œ í…ŒìŠ¤íŠ¸</h2>
        <div id="instagram-status" class="status info">ë¡œë”© ì¤‘...</div>
        
        <blockquote class="instagram-media" data-instgrm-permalink="https://www.instagram.com/p/C_123456/" data-instgrm-version="14">
            <div style="background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin: 1px; max-width:540px; min-width:326px; padding:0; width:99.375%; width:-webkit-calc(100% - 2px); width:calc(100% - 2px);">
                <div style="padding:16px;">
                    <div style="display: flex; flex-direction: row; align-items: center;">
                        <div style="background-color: #F4F4F4; border-radius: 50%; flex-grow: 0; height: 40px; margin-right: 14px; width: 40px;"></div>
                        <div style="display: flex; flex-direction: column; flex-grow: 1; justify-content: center;">
                            <div style="background-color: #F4F4F4; border-radius: 4px; flex-grow: 0; height: 14px; margin-bottom: 6px; width: 100px;"></div>
                            <div style="background-color: #F4F4F4; border-radius: 4px; flex-grow: 0; height: 14px; width: 60px;"></div>
                        </div>
                    </div>
                    <div style="padding: 19% 0;"></div>
                </div>
            </div>
        </blockquote>
    </div>

    <!-- 2. Twitter ì„ë² ë“œ í…ŒìŠ¤íŠ¸ -->
    <div class="test-section">
        <h2>ğŸ¦ Twitter ì„ë² ë“œ í…ŒìŠ¤íŠ¸</h2>
        <div id="twitter-status" class="status info">ë¡œë”© ì¤‘...</div>
        
        <blockquote class="twitter-tweet" data-lang="ko" data-theme="light">
            <p lang="ko" dir="ltr">í…ŒìŠ¤íŠ¸ íŠ¸ìœ—ì…ë‹ˆë‹¤.</p>
            &mdash; í…ŒìŠ¤íŠ¸ ê³„ì • (@test) 
            <a href="https://twitter.com/test/status/123456789">2024ë…„ 1ì›” 1ì¼</a>
        </blockquote>
    </div>

    <!-- 3. ìŠ¤í¬ë¦½íŠ¸ ë¡œë”© ìƒíƒœ -->
    <div class="test-section">
        <h2>âš™ï¸ ìŠ¤í¬ë¦½íŠ¸ ë¡œë”© ìƒíƒœ</h2>
        <div id="script-status">
            <div id="instagram-script-status" class="status warning">í™•ì¸ ì¤‘...</div>
            <div id="twitter-script-status" class="status warning">í™•ì¸ ì¤‘...</div>
        </div>
    </div>

    <!-- 4. íƒ€ì´ë° í…ŒìŠ¤íŠ¸ -->
    <div class="test-section">
        <h2>â±ï¸ ë¡œë”© íƒ€ì´ë° ë¶„ì„</h2>
        <div id="timing-log" class="log">
            <div id="timing-content">íƒ€ì´ë° ë¶„ì„ ì‹œì‘...</div>
        </div>
    </div>

    <script>
        // ë¡œê·¸ í•¨ìˆ˜
        function addLog(message, type = 'info') {
            const logContent = document.getElementById('log-content');
            const timestamp = new Date().toLocaleTimeString();
            logContent.innerHTML += `<br>[${timestamp}] ${message}`;
            
            const timingContent = document.getElementById('timing-content');
            timingContent.innerHTML += `<br>[${timestamp}] ${message}`;
            
            console.log(`[${timestamp}] ${message}`);
        }

        // í˜ì´ì§€ ë¡œë”© ì‹œì  ê¸°ë¡
        const pageStartTime = performance.now();
        addLog('í˜ì´ì§€ ë¡œë”© ì‹œì‘');

        // DOM ë¡œë”© ì™„ë£Œ ì‹œì 
        document.addEventListener('DOMContentLoaded', function() {
            const domLoadTime = performance.now();
            addLog(`DOM ë¡œë”© ì™„ë£Œ (${Math.round(domLoadTime - pageStartTime)}ms)`);
            
            // ìŠ¤í¬ë¦½íŠ¸ ìƒíƒœ í™•ì¸
            checkScriptStatus();
        });

        // í˜ì´ì§€ ì™„ì „ ë¡œë”© ì™„ë£Œ ì‹œì 
        window.addEventListener('load', function() {
            const pageLoadTime = performance.now();
            addLog(`í˜ì´ì§€ ì™„ì „ ë¡œë”© ì™„ë£Œ (${Math.round(pageLoadTime - pageStartTime)}ms)`);
            
            // ë¡œë”© ì™„ë£Œ í›„ ì„ë² ë“œ ì²˜ë¦¬ ì‹œë„
            setTimeout(() => {
                processEmbeds();
            }, 100);
        });

        // ìŠ¤í¬ë¦½íŠ¸ ìƒíƒœ í™•ì¸ í•¨ìˆ˜
        function checkScriptStatus() {
            const instagramStatus = document.getElementById('instagram-script-status');
            const twitterStatus = document.getElementById('twitter-script-status');
            
            // Instagram ìŠ¤í¬ë¦½íŠ¸ í™•ì¸
            if (window.instgrm) {
                instagramStatus.textContent = 'âœ… Instagram ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œë¨';
                instagramStatus.className = 'status success';
                addLog('Instagram ìŠ¤í¬ë¦½íŠ¸ ê°ì§€ë¨');
            } else {
                instagramStatus.textContent = 'âŒ Instagram ìŠ¤í¬ë¦½íŠ¸ ì—†ìŒ';
                instagramStatus.className = 'status error';
                addLog('Instagram ìŠ¤í¬ë¦½íŠ¸ ê°ì§€ ì•ˆë¨');
            }
            
            // Twitter ìŠ¤í¬ë¦½íŠ¸ í™•ì¸
            if (window.twttr) {
                twitterStatus.textContent = 'âœ… Twitter ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œë¨';
                twitterStatus.className = 'status success';
                addLog('Twitter ìŠ¤í¬ë¦½íŠ¸ ê°ì§€ë¨');
            } else {
                twitterStatus.textContent = 'âŒ Twitter ìŠ¤í¬ë¦½íŠ¸ ì—†ìŒ';
                twitterStatus.className = 'status error';
                addLog('Twitter ìŠ¤í¬ë¦½íŠ¸ ê°ì§€ ì•ˆë¨');
            }
        }

        // ì„ë² ë“œ ì²˜ë¦¬ í•¨ìˆ˜
        function processEmbeds() {
            addLog('ì„ë² ë“œ ì²˜ë¦¬ ì‹œì‘');
            
            // Instagram ì„ë² ë“œ ì²˜ë¦¬
            if (window.instgrm && window.instgrm.Embeds) {
                try {
                    addLog('Instagram Embeds.process() ì‹¤í–‰');
                    window.instgrm.Embeds.process();
                    document.getElementById('instagram-status').textContent = 'âœ… Instagram ì²˜ë¦¬ ì™„ë£Œ';
                    document.getElementById('instagram-status').className = 'status success';
                } catch (error) {
                    addLog(`Instagram ì²˜ë¦¬ ì˜¤ë¥˜: ${error.message}`, 'error');
                    document.getElementById('instagram-status').textContent = 'âŒ Instagram ì²˜ë¦¬ ì‹¤íŒ¨';
                    document.getElementById('instagram-status').className = 'status error';
                }
            } else {
                addLog('Instagram ìŠ¤í¬ë¦½íŠ¸ ì•„ì§ ë¡œë“œë˜ì§€ ì•ŠìŒ');
                document.getElementById('instagram-status').textContent = 'â³ Instagram ìŠ¤í¬ë¦½íŠ¸ ëŒ€ê¸° ì¤‘';
                document.getElementById('instagram-status').className = 'status warning';
            }
            
            // Twitter ì„ë² ë“œ ì²˜ë¦¬
            if (window.twttr && window.twttr.widgets) {
                try {
                    addLog('Twitter widgets.load() ì‹¤í–‰');
                    window.twttr.widgets.load();
                    document.getElementById('twitter-status').textContent = 'âœ… Twitter ì²˜ë¦¬ ì™„ë£Œ';
                    document.getElementById('twitter-status').className = 'status success';
                } catch (error) {
                    addLog(`Twitter ì²˜ë¦¬ ì˜¤ë¥˜: ${error.message}`, 'error');
                    document.getElementById('twitter-status').textContent = 'âŒ Twitter ì²˜ë¦¬ ì‹¤íŒ¨';
                    document.getElementById('twitter-status').className = 'status error';
                }
            } else {
                addLog('Twitter ìŠ¤í¬ë¦½íŠ¸ ì•„ì§ ë¡œë“œë˜ì§€ ì•ŠìŒ');
                document.getElementById('twitter-status').textContent = 'â³ Twitter ìŠ¤í¬ë¦½íŠ¸ ëŒ€ê¸° ì¤‘';
                document.getElementById('twitter-status').className = 'status warning';
            }
        }

        // ì£¼ê¸°ì ìœ¼ë¡œ ìŠ¤í¬ë¦½íŠ¸ ìƒíƒœ í™•ì¸ (ìµœëŒ€ 10ì´ˆ)
        let checkCount = 0;
        const maxChecks = 20; // 10ì´ˆ (500ms * 20)
        
        const intervalId = setInterval(() => {
            checkCount++;
            addLog(`ìŠ¤í¬ë¦½íŠ¸ ìƒíƒœ í™•ì¸ #${checkCount}`);
            checkScriptStatus();
            
            if (checkCount >= maxChecks) {
                clearInterval(intervalId);
                addLog('ìŠ¤í¬ë¦½íŠ¸ ìƒíƒœ í™•ì¸ ì¢…ë£Œ');
            }
            
            // ë‘˜ ë‹¤ ë¡œë“œë˜ë©´ ì²˜ë¦¬ ì‹œë„
            if (window.instgrm && window.twttr) {
                addLog('ëª¨ë“  ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì™„ë£Œ, ì„ë² ë“œ ì²˜ë¦¬');
                processEmbeds();
                clearInterval(intervalId);
            }
        }, 500);

        // ìˆ˜ë™ í…ŒìŠ¤íŠ¸ ë²„íŠ¼ë“¤
        function manualInstagramTest() {
            addLog('ìˆ˜ë™ Instagram í…ŒìŠ¤íŠ¸ ì‹œì‘');
            if (window.instgrm && window.instgrm.Embeds) {
                window.instgrm.Embeds.process();
                addLog('ìˆ˜ë™ Instagram ì²˜ë¦¬ ì™„ë£Œ');
            } else {
                addLog('Instagram ìŠ¤í¬ë¦½íŠ¸ê°€ ì—†ìŒ');
            }
        }

        function manualTwitterTest() {
            addLog('ìˆ˜ë™ Twitter í…ŒìŠ¤íŠ¸ ì‹œì‘');
            if (window.twttr && window.twttr.widgets) {
                window.twttr.widgets.load();
                addLog('ìˆ˜ë™ Twitter ì²˜ë¦¬ ì™„ë£Œ');
            } else {
                addLog('Twitter ìŠ¤í¬ë¦½íŠ¸ê°€ ì—†ìŒ');
            }
        }

        // ì „ì—­ í•¨ìˆ˜ë¡œ ë…¸ì¶œ
        window.manualInstagramTest = manualInstagramTest;
        window.manualTwitterTest = manualTwitterTest;
        window.checkScriptStatus = checkScriptStatus;
        window.processEmbeds = processEmbeds;
    </script>

    <!-- ìˆ˜ë™ í…ŒìŠ¤íŠ¸ ë²„íŠ¼ë“¤ -->
    <div class="test-section">
        <h2>ğŸ§ª ìˆ˜ë™ í…ŒìŠ¤íŠ¸</h2>
        <button onclick="manualInstagramTest()" style="margin: 5px; padding: 10px; background: #e1306c; color: white; border: none; border-radius: 4px;">
            Instagram ìˆ˜ë™ ì²˜ë¦¬
        </button>
        <button onclick="manualTwitterTest()" style="margin: 5px; padding: 10px; background: #1da1f2; color: white; border: none; border-radius: 4px;">
            Twitter ìˆ˜ë™ ì²˜ë¦¬
        </button>
        <button onclick="checkScriptStatus()" style="margin: 5px; padding: 10px; background: #6c757d; color: white; border: none; border-radius: 4px;">
            ìŠ¤í¬ë¦½íŠ¸ ìƒíƒœ í™•ì¸
        </button>
        <button onclick="processEmbeds()" style="margin: 5px; padding: 10px; background: #28a745; color: white; border: none; border-radius: 4px;">
            ì„ë² ë“œ ì²˜ë¦¬ ì‹¤í–‰
        </button>
    </div>

    <!-- Instagram ìŠ¤í¬ë¦½íŠ¸ -->
    <script async src="https://www.instagram.com/embed.js"></script>
    <!-- Twitter ìŠ¤í¬ë¦½íŠ¸ -->
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</body>
</html>
